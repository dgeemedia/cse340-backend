<!-- views/messages/inbox.ejs -->
<div class="container">
  <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:14px;">
    <h1 style="margin:0;">Inbox</h1>
    <div>
      <a href="/account/messages/compose" class="btn">Compose</a>
      <a href="/account/messages/outbox" class="btn">Sent</a>
    </div>
  </div>

  <table class="card" style="width:100%; border-collapse:collapse;">
    <thead>
      <tr>
        <th>From</th>
        <th>Subject</th>
        <th>Date</th>
        <th>Read</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% if (Array.isArray(inbox) && inbox.length) { %>
        <% inbox.forEach(m => { %>
          <tr style="<%= m.is_read ? '' : 'font-weight:700' %>">
            <td><%= m.sender_first || 'System' %></td>
            <td>
              <a href="/account/messages/view/<%= m.message_id %>">
                <%= m.subject || '(no subject)' %>
              </a>
            </td>
            <td><%= new Date(m.created_at).toLocaleString() %></td>
            <td style="text-align:center;">
              <input type="checkbox" class="mark-read" data-id="<%= m.message_id %>" <%= m.is_read ? 'checked' : '' %>>
            </td>
            <td>
              <form action="/account/messages/delete" method="post" class="inline-delete-form" style="display:inline">
                <input type="hidden" name="message_id" value="<%= m.message_id %>">
                <button class="btn btn-delete" type="submit">Delete</button>
              </form>
            </td>
          </tr>
        <% }) %>
      <% } else { %>
        <tr>
          <td colspan="5" style="text-align:center; padding:18px;">No messages in your inbox.</td>
        </tr>
      <% } %>
    </tbody>
  </table>
</div>


<script src="/js/messages.js"></script>

